<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,user-scalable=no"  />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  
  <style>
    model-viewer {
      position:absolute;
      border: 0;
      border-radius: 0%;
      margin: 0 auto;
      height:50%;
      width:50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%,-50%);
    }
		
	</style>
  </head>

  <body>
	<audio id="bg-audio" loop>
		<source src="bgm.mp3" type="audio/mp3">
		Your browser does not support the audio element.
	</audio>
	  <model-viewer id="gameboy" src="ball1.glb"
			ios-src="../Model_Gameboy.usdz"
			alt="A 3D model of an astronaut"
      ar
      ar-modes="scene-viewer"
      disable-zoom
			auto-rotate
	    camera-controls>
      <button slot="ar-button" style="display: none;"></button>
    </model-viewer>
    <button id='ar' style="background-color: white; border-radius: 4px; border: none; position: absolute; top: 16px; right: 16px; ">
      進入AR模式
    </button>
  </body>


  <script>
    // 获取返回按钮
    let audioFiles = ['sound1.mp3', 'sound2.mp3', 'sound3.mp3']; // 音效文件列表
    let currentAudioIndex = 0; // 当前播放音效的索引
    let audioElement = document.getElementById('bg-audio'); // 获取音效元素

    const modelViewer = document.querySelector('model-viewer');
    
    var date = new Date();
    console.log(date.getMinutes());
    if(date.getHours()<11){
      modelViewer.src='ball1.glb';
    }
    else{
      modelViewer.src='ball.glb';
    }
    function isMobileDeviceAR() {
      const userAgent = navigator.userAgent.toLowerCase();
      return /iphone|ipod|android|windows phone|blackberry|iemobile/.test(userAgent);
    }

    const music = document.getElementById('background-music');
    const arbutton = document.getElementById('ar');
    arbutton.addEventListener("click", function() {
      // 尝试关闭当前页面
      changeAudio();  // 播放第一种音效
      setInterval(changeAudio, 10 * 60 * 1000);  // 每10分钟切换一次音效
      modelViewer.activateAR();
      //music.play();
    });

    function changeAudio() {
      audioElement.src = audioFiles[currentAudioIndex];
      audioElement.play();  // 播放音效

      // 更新当前音效索引，循环播放音效
      currentAudioIndex = (currentAudioIndex + 1) % audioFiles.length;
    }
  </script>
</html>
