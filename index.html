<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,user-scalable=no"  />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  
  <style>
    model-viewer {
      position:absolute;
      border: 0;
      border-radius: 0%;
      margin: 0 auto;
      height:50%;
      width:80%;
      top: 50%;
      left: 50%;
      transform: translate(-50%,-50%);
    }
    #ar {
      background-color: rgba(0, 0, 0, 0.396);
      border-radius: 4px;
      border: none;
      position: absolute;
      top: 20%;
      left: 50%;
      transform: translateX(-50%); /* 使按钮真正居中 */
      height: 10%;
      font-size: 20px; /* 控制字体大小 */
    }
	</style>
  </head>

  <body>
	<audio id="bg-audio" loop>
		<source src="" type="audio/mp3">
		Your browser does not support the audio element.
	</audio>
	  <model-viewer id="gameboy" 
      reveal="manual"
      poster="image/ball1.png"
      src="ball1.glb"
			ios-src="../Model_Gameboy.usdz"
			alt="A 3D model of an astronaut"
      ar
      ar-modes="scene-viewer"
      disable-zoom
			auto-rotate
	    camera-controls>
      <button slot="ar-button" style="display: none;"></button>
    </model-viewer>
    <button id='ar'>
      進入AR模式
    </button>
  </body>


  <script>
    let audioFiles = ['sounds/sound1.mp3', 'sounds/sound2.mp3', 'sounds/sound3.mp3']; // 音效文件列表
    let currentAudioIndex = 0; // 当前播放音效的索引
    let audioElement = document.getElementById('bg-audio'); // 获取音效元素

    const modelViewer = document.querySelector('model-viewer');
    
    var date = new Date();
    console.log(date.getMinutes());
    if(date.getHours()<11){
      modelViewer.src='ball1.glb';
      modelViewer.poster='image/ball1.png';
    }
    else{
      modelViewer.src='ball.glb';
      modelViewer.poster='image/ball.png';
    }
    function isMobileDeviceAR() {
      const userAgent = navigator.userAgent.toLowerCase();
      return /iphone|ipod|android|windows phone|blackberry|iemobile/.test(userAgent);
    }

    const music = document.getElementById('background-music');
    const arbutton = document.getElementById('ar');
    arbutton.addEventListener("click", function() {
      // 尝试关闭当前页面
      changeAudio();  // 播放第一种音效
      setInterval(changeAudio, 60 * 1000);  // 每10分钟切换一次音效
      modelViewer.activateAR();
      //music.play();
    });

    function changeAudio() {
      audioElement.src = audioFiles[currentAudioIndex];
      audioElement.play();  // 播放音效

      // 更新当前音效索引，循环播放音效
      currentAudioIndex = (currentAudioIndex + 1) % audioFiles.length;
    }
  </script>
</html>
